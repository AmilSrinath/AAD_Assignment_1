<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Index</title>
  <link rel="stylesheet" href="assest/bootstrap-5/css/bootstrap.min.css">
  <link rel="stylesheet" href="Style.css">
  <link rel="stylesheet" href="assest/fontawesome-free-6/css/all.min.css">
</head>
<body>

<nav id="nav" class="navbar navbar-expand-lg">
  <a class="navbar-brand" href="">
    <h2>POS</h2>
  </a>

  <div class="navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" id="customer-nav">Customer</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="store-nav">Store</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="place-order-nav">Place Order</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="OrderHistory-nav">Order History</a>
      </li>
    </ul>
  </div>

  <div id="currentDateContainer"><span id="currentDate"></span></div>
</nav>

  <!--HomeForm-->
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
      <img src="assest/3979020.jpg" alt="">
      <p>WELCOME <br> TO <br> POINT OF SALE <br> SYSTEM</p>
    </div>
  </div>

  <!--Customer-->
  <div id="customerForm" class="container">
    <p id="customer">Customer</p>
    <div class="row">
      <!--Form-->
      <div class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
        <form id="customer_Form">
          <div class="mb-3">
            <label for="cus_id" class="form-label">Cus_ID</label>
            <input type="text" class="form-control" id="cus_id" disabled>
          </div>

          <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" id="name">
          </div>

          <div class="mb-3">
            <label for="nic" class="form-label">NIC</label>
            <input type="text" class="form-control" id="nic">
          </div>

          <div class="form-floating">
            <textarea class="form-control" placeholder="Enter your address" id="address" style="height: 100px"></textarea>
            <label for="address">Address</label>
          </div>


          <div id="customerbtns" class="mt-4">
            <button type="button" class="btn btn-success">Submit</button>
            <button type="button" class="btn btn-primary">Update</button>
            <button type="button" class="btn btn-danger">Delete</button>
            <button type="button" class="btn btn-warning">Reset</button>
          </div>
        </form>
      </div>
      <!--Table-->
      <div class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
        <table class="table">
          <thead>
          <tr>
            <th class="table-heading" scope="col">Cus_ID</th>
            <th class="table-heading" scope="col">Name</th>
            <th class="table-heading" scope="col">NIC</th>
            <th class="table-heading" scope="col">Address</th>
          </tr>
          </thead>
          <tbody class="table-tr" id="customer-tbl-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!--Store-->
  <div id="storeForm" class="container">
  <p id="store">Store</p>
  <div class="row">
    <!--Form-->
    <div class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
      <form>
        <div class="mb-3">
          <label for="item_id" class="form-label">Item_ID</label>
          <input type="text" class="form-control" id="item_id" disabled>
        </div>

        <div class="mb-3">
          <label for="item_name" class="form-label">Item_Name</label>
          <input type="text" class="form-control" id="item_name">
        </div>

        <div class="mb-3">
          <label for="quantity" class="form-label">Quantity</label>
          <input type="text" class="form-control" id="quantity">
        </div>

        <div class="mb-3">
          <label for="price" class="form-label">Price</label>
          <input type="text" class="form-control" id="price">
        </div>

        <div class="form-floating">
          <textarea class="form-control" placeholder="Enter Description" id="description" style="height: 100px"></textarea>
          <label for="description">Description</label>
        </div>


        <div id="storebtns" class="mt-4">
          <button type="button" class="btn btn-success">Submit</button>
          <button type="button" class="btn btn-primary">Update</button>
          <button type="button" class="btn btn-danger">Delete</button>
          <button type="button" class="btn btn-warning">Reset</button>
        </div>
      </form>
    </div>
    <!--Table-->
    <div class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
      <table class="table">
        <thead>
        <tr>
          <th class="table-heading" scope="col">Item_ID</th>
          <th class="table-heading" scope="col">Item_Name</th>
          <th class="table-heading" scope="col">Quantity</th>
          <th class="table-heading" scope="col">Price</th>
          <th class="table-heading" scope="col">Description</th>
        </tr>
        </thead>
        <tbody class="table-tr" id="item-tbl-body"></tbody>
      </table>
    </div>
  </div>
</div>

  <!--Place Order-->
  <div id="placeOrderForm" class="container">
  <p id="placeOrder">Place Order</p>
  <div class="row">
    <!--Form-->
    <div id="PlaceOrderTextField" class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
      <form>
        <div id="placeOrderText1">
          <div class="mt-lg-2 mb-lg-2 m-lg-3">
            <label for="Order_id" class="form-label">Order_ID</label>
            <h3 id="Order_id">O001</h3>
          </div>
        </div>

        <div id="placeOrderText3" class="mb-lg-2">
          <div class="mt-lg-2 mb-lg-2 m-lg-3">
            <label for="selectCus_ID" class="form-label">Customer Name</label>
            <select id="selectCus_ID" class="form-select mb-3" aria-label="Default select example"></select>
          </div>
        </div>

        <div id="placeOrderText2">
          <div class="m-lg-3">
            <label for="select" class="form-label">Select Item ID</label>
            <select id="select" class="form-select mb-3" aria-label="Default select example"></select>

            <div id="ItemNameDiv">
              <label for="itemName" class="form-label">  Item Name :</label>
              <h5 id="itemName">______________________________</h5>
            </div>

            <div id="ItemQutDiv">
              <label for="itemQut" class="form-label">  Hand On Quantity :</label>
              <h5 id="itemQut">_____________</h5>
            </div>

            <div id="ItemPriceDiv">
              <label for="itemPrice" class="form-label">  Unite Price :</label>
              <h5 id="itemPrice">___________</h5>
            </div>

            <div class="mb-3">
              <label for="quantity" class="form-label">Quantity</label>
              <input type="number" class="form-control" id="quantity_placeOrder">
            </div>

            <div id="placeOrderbtns" class="mt-4">
              <button type="button" class="btn btn-success">Add</button>
              <button id="placeOrderbtnResetbtn" type="reset" class="btn btn-warning">Reset</button>
            </div>
          </div>
        </div>
      </form>
    </div>
    <!--Table-->
    <div class="col col-xl-6 col-lg-6 col-md-12 col-sm-12 col12">
      <table id="tblPalceOrder" class="table">
        <thead>
        <tr>
          <th class="table-heading" scope="col">Item_ID</th>
          <th class="table-heading" scope="col">Unite_Price</th>
          <th class="table-heading" scope="col">Quantity</th>
          <th class="table-heading" scope="col">Total</th>
          <th class="table-heading" scope="col">Status</th>
        </tr>
        </thead>
        <tbody class="table-tr" id="placeOrder-tbody"></tbody>
      </table>

      <p id="total" class="fs-2">Total :</p>
      <h2 id="tot">0</h2>

      <div class="input-group mt-2 mb-2">
        <label for="discount"></label>
        <input id="discount" placeholder="Discount" type="number" class="form-control">
        <span class="input-group-text">%</span>
        <button id="calculate">Calculate</button>
      </div>

      <p id="netTot" class="fs-2">Net Total :</p>
      <h2 id="netTotal">0</h2>

      <label for="amount"></label>
      <input id="amount" type="number" class="form-control" placeholder="Amount">

      <div id="placeOrderbtns2" class="mt-4">
        <button id="place_Order" type="button" class="btn btn-primary">Place Order</button>
      </div>
    </div>
  </div>
</div>

<!-- Order History Form -->
<div id="OrderHistoryForm" class="container">
  <p id="OrderHistory">Order History</p>
  <div class="row">
    <!--Table-->
    <div class="col col-xl-12 col-lg-12 col-md-12 col-sm-6 col6">
      <table class="table">
        <thead>
        <tr>
          <th class="table-heading" scope="col">Date</th>
          <th class="table-heading" scope="col">Order_ID</th>
          <th class="table-heading" scope="col">Customer_ID</th>
          <th class="table-heading" scope="col">Net_Total</th>
        </tr>
        </thead>
        <tbody class="table-tr" id="OrderHistory-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<script src="assest/lib/jquery.min.js"></script>
<script src="assest/bootstrap-5/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="assest/fontawesome-free-6/js/all.min.js"></script>

  <script>
    $(document).ready(function() {
      function formatDate(date) {
        const options = {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit'
        };
        return date.toLocaleString('en-US', options);
      }

      const currentDate = new Date();
      const formattedDate = formatDate(currentDate);
      $('#currentDate').text(formattedDate);
    });

    loadAllCustomer();
    loadAllItem();
    $("#customerForm").css('display','none');
    $("#storeForm").css('display','none');
    $("#placeOrderForm").css('display','none');
    $("#OrderHistoryForm").css('display','none');

    //-----------------------------Navigation--------------------------------
    $("#customer-nav").on('click',()=>{
      $("#customerForm").css('display','block');
      $("#storeForm").css('display','none');
      $("#placeOrderForm").css('display','none');
      $("#myTabContent").css('display','none');
      $("#OrderHistoryForm").css('display','none');
      loadAllCustomer();
      setTimeout(After1Minute, 60);
    })

    $("#store-nav").on('click',()=>{
      $("#customerForm").css('display','none');
      $("#storeForm").css('display','block');
      $("#placeOrderForm").css('display','none');
      $("#myTabContent").css('display','none');
      $("#OrderHistoryForm").css('display','none');
      loadAllItem();
      setTimeout(After1Minute, 60);
    })

    $("#place-order-nav").on('click',()=>{
      $("#customerForm").css('display','none');
      $("#storeForm").css('display','none');
      $("#placeOrderForm").css('display','block');
      $("#myTabContent").css('display','none');
      $("#OrderHistoryForm").css('display','none');
      loadAllCustomer();
    })

    $("#OrderHistory-nav").on('click',()=>{
      $("#customerForm").css('display','none');
      $("#storeForm").css('display','none');
      $("#placeOrderForm").css('display','none');
      $("#myTabContent").css('display','none');
      $("#OrderHistoryForm").css('display','block');
      loadAllOrder();
    });

    /* ------------------------------Form Design----------------------------------- */

    $("#customer-nav").on('click',()=>{
      $("#customer-nav").css('background','white');
      $("#customer-nav").css('color','black');

      $("#store-nav").css('background','#0d6efd');
      $("#store-nav").css('color','white');

      $("#place-order-nav").css('background','#0d6efd');
      $("#place-order-nav").css('color','white');

      $("#OrderHistory-nav").css('background','#0d6efd');
      $("#OrderHistory-nav").css('color','white');
    })

    $("#store-nav").on('click',()=>{
      $("#store-nav").css('background','white');
      $("#store-nav").css('color','black');

      $("#customer-nav").css('background','#0d6efd');
      $("#customer-nav").css('color','white');

      $("#place-order-nav").css('background','#0d6efd');
      $("#place-order-nav").css('color','white');

      $("#OrderHistory-nav").css('background','#0d6efd');
      $("#OrderHistory-nav").css('color','white');
    })

    $("#place-order-nav").on('click',()=>{
      $("#place-order-nav").css('background','white');
      $("#place-order-nav").css('color','black');

      $("#customer-nav").css('background','#0d6efd');
      $("#customer-nav").css('color','white');

      $("#store-nav").css('background','#0d6efd');
      $("#store-nav").css('color','white');

      $("#OrderHistory-nav").css('background','#0d6efd');
      $("#OrderHistory-nav").css('color','white');
    })

    $("#OrderHistory-nav").on('click',()=>{
      $("#OrderHistory-nav").css('background','white');
      $("#OrderHistory-nav").css('color','black');

      $("#place-order-nav").css('background','#0d6efd');
      $("#place-order-nav").css('color','white');

      $("#customer-nav").css('background','#0d6efd');
      $("#customer-nav").css('color','white');

      $("#store-nav").css('background','#0d6efd');
      $("#store-nav").css('color','white');
    })

    //-----------------------------Customer--------------------------------
    var row_index = null;
    var allItem;
    var lastCustomer;
    var customerCount;

    function loadAllCustomer() {
      $("#customer-tbl-body").empty();

      $("#selectCus_ID").empty();
      $("#selectCus_ID").html(`<option className="options">Select Customer</option>`);

      $.ajax({
        url: "http://localhost:8080/Assignment/customer",
        type: "GET",
        success: function (response) {
          for (const customer of response){
            let record = `<tr><td class="cus_id">${customer.cus_id}</td><td class="name">${customer.name}</td><td class="nic">${customer.nic}</td><td class="address">${customer.address}</td></tr>`;
            $("#customer-tbl-body").append(record);
          }
          for (const customer of response){
            let recode = `<option class="options">${customer.name}</option>`
            $("#selectCus_ID").append(recode);
          }

          lastCustomer = response[response.length - 1];
          customerCount = response.length;
        }
      })
    }

    //generate Customer_ID
    function generateCustomerID() {
      if (customerCount === 0) {
        $("#cus_id").val("C001");
      } else {
        const lastID = lastCustomer.cus_id.split("C");
        const lastNumber = parseInt(lastID[1], 10);
        const newNumber = lastNumber + 1;
        const newID = "C" + newNumber.toString().padStart(3, '0');
        $("#cus_id").val(newID);
      }
    }

    // Submit
    $("#customerbtns > button[type='button']").eq(0).on("click", () => {
      let cus_id = $("#cus_id").val();
      let name = $("#name").val();
      let nic = $("#nic").val();
      let address = $("#address").val();

      const customer = {
        cus_id: cus_id,
        name: name,
        nic: nic,
        address: address
      };

      const custJSON = JSON.stringify(customer);

      const sendAjax = (customerJSON) => {
        $.ajax({
          url: "http://localhost:8080/Assignment/customer",
          type: "POST",
          data: customerJSON,
          contentType: "application/json",
          success: function () {
            loadAllCustomer();
            $("#customerbtns>button[type='button']").eq(3).click();
            Swal.fire({
              icon: 'success',
              title: 'Customer Saved Successful',
              showConfirmButton: false,
              timer: 1500
            })
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Please Check Text Field',
              text: 'Something went wrong!'
            })
          }
        });
      };
      sendAjax(custJSON);
      setTimeout(After1Minute, 60);
    });

    function After1Minute() {
      generateCustomerID();
      generateItemID();
      generateOrderID();
    }

    //Click Row
    $("#customer-tbl-body").on("click", "tr", function() {
      row_index = $(this).index();

      let cus_id = $(this).find(".cus_id").text();
      let name = $(this).find(".name").text();
      let nic = $(this).find(".nic").text();
      let address = $(this).find(".address").text();

      $("#cus_id").val(cus_id);
      $("#name").val(name);
      $("#nic").val(nic);
      $("#address").val(address);
    })

    $("#customerbtns>button[type='button']").eq(3).on("click", () => {
      setTimeout(After1Minute, 60);
      $("#name").val("");
      $("#nic").val("");
      $("#address").val("");
    });

    //Update
    $("#customerbtns>button[type='button']").eq(1).on("click", () => {
      let cus_id = $("#cus_id").val();
      let name = $("#name").val();
      let nic = $("#nic").val();
      let address = $("#address").val();

      const customer = {
        cus_id: cus_id,
        name: name,
        nic: nic,
        address: address
      };

      const custJSON = JSON.stringify(customer);

      const sendAjax = (customerJSON) => {
        $.ajax({
          url: "http://localhost:8080/Assignment/customer",
          type: "PUT",
          data: customerJSON,
          contentType: "application/json",
          success: function () {
            loadAllCustomer();
            $("#customerbtns>button[type='button']").eq(3).click();
            Swal.fire({
              icon: 'success',
              title: 'Customer Update Successful',
              showConfirmButton: false,
              timer: 1500
            })
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Please Check Text Field',
              text: 'Something went wrong!'
            })
          }
        });
      };
      sendAjax(custJSON);
      setTimeout(After1Minute, 60);
    });

    //Delete
    $("#customerbtns>button[type='button']").eq(2).on("click", () => {
      let cus_id = $("#cus_id").val();

      Swal.fire({
        title: 'Are you sure?',
        text: "You want delete row?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes'
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire(
                  'Deleted!',
                  'Your row has been deleted.',
                  'success'
          )
          setTimeout(After1Minute, 60);
          $("#customerbtns>button[type='button']").eq(3).click();
          $.ajax({
            url: "http://localhost:8080/Assignment/customer?cus_id="+cus_id,
            type: "DELETE",
            success: function () {
              $("#storebtns>button[type='button']").eq(3).click();
              loadAllCustomer();
            }
          });
        }
      })
    })

    //-----------------------------Store--------------------------------
    var row_index1 = null;

    var lastItem;
    var itemCount;

    function loadAllItem() {
      $("#item-tbl-body").empty();

      $("#select").empty();
      $("#select").html(`<option className="options">Select Item ID</option>`);

      $.ajax({
        url: "http://localhost:8080/Assignment/item",
        type: "GET",
        success: function (response) {
          for (const item of response){
            let record = `<tr><td class="item_id">${item.item_id}</td><td class="item_name">${item.item_name}</td><td class="quantity">${item.quantity}</td><td class="price">${item.price}</td><td class="description">${item.description}</td></tr>`;
            $("#item-tbl-body").append(record);
          }
          for (const item of response){
            allItem = response;

            let recode = `<option class="options">${item.item_id}</option>`
            $("#select").append(recode);
          }

          lastItem = response[response.length - 1];
          itemCount = response.length;
        }
      })
    };

    $("#storebtns>button[type='button']").eq(3).on("click", () => {
      setTimeout(After1Minute, 60);
      $("#quantity").val("");
      $("#item_name").val("");
      $("#price").val("");
      $("#description").val("");
    });

    //generate Customer_ID
    function generateItemID() {
      if (itemCount === 0) {
        $("#item_id").val("I001");
      } else {
        const lastID = lastItem.item_id.split("I");
        const lastNumber = parseInt(lastID[1], 10);
        const newNumber = lastNumber + 1;
        const newID = "I" + newNumber.toString().padStart(3, '0');
        $("#item_id").val(newID);
      }
    }

    //Submit
    $("#storebtns>button[type='button']").eq(0).on("click", () => {
      let item_id = $("#item_id").val();
      let item_name = $("#item_name").val();
      let quantity = $("#quantity").val();
      let price = $("#price").val();
      let description = $("#description").val();

      //------------------------------------------------------
      const item = {
        item_id: item_id,
        item_name: item_name,
        quantity: quantity,
        price: price,
        description: description
      };

      const item_JSON = JSON.stringify(item);

      const sendAjax = (itemJSON) => {
        $.ajax({
          url: "http://localhost:8080/Assignment/item",
          type: "POST",
          data: itemJSON,
          contentType: "application/json",
          success: function () {
            loadAllItem();
            $("#storebtns>button[type='button']").eq(3).click();
            Swal.fire({
              icon: 'success',
              title: 'Item Saved Successful',
              showConfirmButton: false,
              timer: 1500
            })
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Please Check Text Field',
              text: 'Something went wrong!'
            })
          }
        });
      };
      sendAjax(item_JSON);
      setTimeout(After1Minute, 60);
    });

    //Click Row
    $("tbody").on("click", "tr", function() {
      row_index1 = $(this).index();

      let item_id = $(this).find(".item_id").text();
      let item_name = $(this).find(".item_name").text();
      let quantity = $(this).find(".quantity").text();
      let price = $(this).find(".price").text();
      let description = $(this).find(".description").text();

      $("#item_id").val(item_id);
      $("#item_name").val(item_name);
      $("#quantity").val(quantity);
      $("#price").val(price);
      $("#description").val(description);
    });

    //Update
    $("#storebtns>button[type='button']").eq(1).on("click", () => {
      let item_id = $("#item_id").val();
      let item_name = $("#item_name").val();
      let quantity = $("#quantity").val();
      let price = $("#price").val();
      let description = $("#description").val();

      const item = {
        item_id: item_id,
        item_name: item_name,
        quantity: quantity,
        price: price,
        description: description
      };

      const item_JSON = JSON.stringify(item);

      const sendAjax = (itemJSON) => {
        $.ajax({
          url: "http://localhost:8080/Assignment/item",
          type: "PUT",
          data: itemJSON,
          contentType: "application/json",
          success: function () {
            loadAllItem();
            $("#storebtns>button[type='button']").eq(3).click();
            Swal.fire({
              icon: 'success',
              title: 'Item Update Successful',
              showConfirmButton: false,
              timer: 1500
            })
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Please Check Text Field',
              text: 'Something went wrong!'
            })
          }
        });
      };
      sendAjax(item_JSON);
      setTimeout(After1Minute, 60);
    });

    //Delete
    $("#storebtns>button[type='button']").eq(2).on("click", () => {
      let item_id = $("#item_id").val();

      Swal.fire({
        title: 'Are you sure?',
        text: "You want delete row?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes'
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire(
                  'Deleted!',
                  'Your row has been deleted.',
                  'success'
          )
          setTimeout(After1Minute, 60);
          $.ajax({
            url: "http://localhost:8080/Assignment/item?item_id="+item_id,
            type: "DELETE",
            success: function () {
              $("#storebtns>button[type='button']").eq(3).click();
              loadAllItem();
            }
          });
        }
      })
    });


    //-----------------------------Place Order--------------------------------

    var lastOrder;
    var orderCount;

    function loadAllOrder() {
      $("#OrderHistory-tbody").empty();
      $.ajax({
        url: "http://localhost:8080/Assignment/order",
        type: "GET",
        success: function (response) {
          for (const order of response){
            let recode = `<tr><td class='date'>${order.date}</td><td class='order_id'>${order.order_id}</td><td class='cus_id'>${order.customer_id}</td><td class='net_total'>${order.net_total}</td></tr>`
            $("#OrderHistory-tbody").append(recode);
          }

          lastOrder = response[response.length - 1];
          orderCount = response.length;
        }
      })
    }

    //generate Customer_ID
    function generateOrderID() {
      if (orderCount === 0) {
        $('#Order_id').text("O001");
      } else {
        const lastID = lastOrder.orderId.split("O");
        const lastNumber = parseInt(lastID[1], 10);
        const newNumber = lastNumber + 1;
        const newID = "O" + newNumber.toString().padStart(3, '0');
        $('#Order_id').text(newID);
      }
    }

    //Combo Box Row Click
    $(document).ready(function() {
      $('#select').change(function(){
        var selectedOption = $(this).find('option:selected');
        let item_id = selectedOption.val();

        for (const item of allItem){
          if (item_id===item.item_id){
            $('#itemName').text(item.item_name);
            $('#itemQut').text(item.quantity);
            $('#itemPrice').text(item.price);
          }
        }
            $('#quantity_placeOrder').focus();
      });
    });

    document.getElementById("select").addEventListener("change", function() {
      if($('#select').val() === "Select Item ID"){
        $('#itemName').text("______________________________");
        $('#itemQut').text("_____________");
        $('#itemPrice').text("___________");
      }
    });


    //Add Button
    $("#placeOrderbtns>button[type='button']").eq(0).on("click", () => {

      let item_id = $("#select").val();
      let quantity;
      let unit_price;
      let total;

      var itemElement;

      for (const item of allItem){
        if (item_id===item.item_id){
          itemElement = item;
          quantity = parseInt($("#quantity_placeOrder").val());
          unit_price = parseFloat(item.price);
          total = quantity * unit_price;
        }
      }

      let existingRow = $(`#placeOrder-tbody tr[data-item-id="${item_id}"]`);

      if (existingRow.length) {
        let existingQuantity = parseInt(existingRow.find('.quantity').text());
        let newQuantity = existingQuantity + quantity;
        let newTotal = newQuantity * unit_price;

        if (itemElement && newQuantity <= itemElement.quantity) {
          existingRow.find('.quantity').text(newQuantity);
          existingRow.find('.price').text(newTotal);
        } else {
          Swal.fire({
            icon: 'error',
            title: 'The quantity is not enough!',
            text: 'Something went wrong!'
          });
        }
      } else {
        if (itemElement && itemElement.quantity >= quantity) {
          let record = `
    <tr data-item-id="${item_id}">
        <td class="item_id">${item_id}</td>
        <td class="item_price">${unit_price}</td>
        <td class="quantity">${quantity}</td>
        <td class="price">${total}</td>
        <td class="button">
            <button class="removeButton" type="button">
                <i class="fas fa-trash"></i>
            </button>
        </td>
    </tr>`;

          $("#placeOrder-tbody").append(record);
        } else {
          Swal.fire({
            icon: 'error',
            title: 'The quantity is not enough!',
            text: 'Something went wrong!'
          });
        }

      }

      let netTot = 0;
      $("#placeOrder-tbody tr").each(function() {
        netTot += parseFloat($(this).find('.price').text());
      });

      $("#tot").text(netTot);

      $(".removeButton").on("click", function() {
        $(this).closest('tr').remove();

        let newNetTot = 0;
        $("#placeOrder-tbody tr").each(function() {
          newNetTot += parseFloat($(this).find('.price').text());
        });

        $("#tot").text(newNetTot);
      });

      $('#itemName').text("______________________________");
      $('#itemQut').text("_____________");
      $('#itemPrice').text("___________");

      $("#select").val("Select Item ID");
      $("#quantity_placeOrder").val("")
    });

    $("#placeOrderbtnResetbtn").eq(0).on("click", () => {
      $('#itemName').text("______________________________");
      $('#itemQut').text("_____________");
      $('#itemPrice').text("___________");
      $('#placeOrder-tbody>tr').remove();
      $("#tot").text(0);
      $('#netTotal').text(0);
    });

    $("#calculate").on("click", () => {
      let tot = $("#tot").text();
      let discount = $("#discount").val();

      $('#netTotal').text(tot*(discount/100));
    });

    //Place Order Button
    $("#place_Order").on('click',()=>{
      let netTotal = parseFloat($('#netTotal').text());
      let date = $('#currentDate').text();
      let order_id = $('#Order_id').text();

      var selectedOption = $('#selectCus_ID').find('option:selected');
      let cusName = selectedOption.val();

      console.log(date);
      console.log(order_id);
      console.log(cusName);
      console.log(netTotal);


      const order = {
        date: date,
        order_id: order_id,
        cusName: cusName,
        netTotal: netTotal
      };

      const order_JSON = JSON.stringify(order);

      console.log(order_JSON)

      const sendAjax = (orderJSON) => {
        $.ajax({
          url: "http://localhost:8080/Assignment/order",
          type: "POST",
          data: orderJSON,
          contentType: "application/json",
          success: function () {
            loadAllItem();
            /*$("#storebtns>button[type='button']").eq(3).click();*/
            Swal.fire({
              icon: 'success',
              title: 'Order Saved Successful',
              showConfirmButton: false,
              timer: 1500
            })
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Please Check Text Field',
              text: 'Something went wrong!'
            })
          }
        });
      };
      sendAjax(order_JSON);
      setTimeout(After1Minute, 60);

    });

    /* ------------------------------Form Design----------------------------------- */

    $("#customer-nav").on('click',()=>{
      $("#customer-nav").css('background','white');
      $("#customer-nav").css('color','black');

      $("#store-nav").css('background','#0d6efd');
      $("#store-nav").css('color','white');

      $("#place-order-nav").css('background','#0d6efd');
      $("#place-order-nav").css('color','white');
    })

    $("#store-nav").on('click',()=>{
      $("#store-nav").css('background','white');
      $("#store-nav").css('color','black');

      $("#customer-nav").css('background','#0d6efd');
      $("#customer-nav").css('color','white');

      $("#place-order-nav").css('background','#0d6efd');
      $("#place-order-nav").css('color','white');
    })

    $("#place-order-nav").on('click',()=>{
      $("#place-order-nav").css('background','white');
      $("#place-order-nav").css('color','black');

      $("#customer-nav").css('background','#0d6efd');
      $("#customer-nav").css('color','white');

      $("#store-nav").css('background','#0d6efd');
      $("#store-nav").css('color','white');
    })

  </script>
</body>
</html>